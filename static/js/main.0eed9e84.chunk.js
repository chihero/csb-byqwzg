(this["webpackJsonpredux-essentials-example"]=this["webpackJsonpredux-essentials-example"]||[]).push([[0],{1350:function(t,e){},1369:function(t,e,n){"use strict";n.r(e);var r=n(9),s=n(18),a=n(4),c=n.n(a),o=n(85),i=n.n(o),u=(n(178),n(43)),d=n(19),j=n(6),p=function(){return Object(j.jsx)("nav",{children:Object(j.jsxs)("section",{children:[Object(j.jsx)("h1",{children:"Redux Essentials Example"}),Object(j.jsx)("div",{className:"navContent",children:Object(j.jsx)("div",{className:"navLinks",children:Object(j.jsx)(u.b,{to:"/",children:"Posts"})})})]})})},l=n(21),b=function(t){var e=t.text,n=void 0===e?"":e,r=t.size,s=void 0===r?"5em":r,a=n?Object(j.jsx)("h4",{children:n}):null;return Object(j.jsxs)("div",{className:"spinner",children:[a,Object(j.jsx)("div",{className:"loader",style:{height:s,width:s}})]})},O=function(t){var e=t.userId,n=Object(l.c)((function(t){return t.users.find((function(t){return t.id===e}))}));return Object(j.jsxs)("span",{children:["by ",n?n.name:"Unknown author"]})},f=n(124),h=n(125),m=function(t){var e=t.timestamp,n="";if(e){var r=Object(f.a)(e),s=Object(h.a)(r);n="".concat(s," ago")}return Object(j.jsxs)("span",{title:e,children:["\xa0 ",Object(j.jsx)("i",{children:n})]})},x=n(7),v=n(26),g=n(5),y=n(94),w=["body"];function S(t){return k.apply(this,arguments)}function k(){return k=Object(s.a)(Object(r.a)().mark((function t(e){var n,s,a,c,o,i,u,d=arguments;return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=d.length>1&&void 0!==d[1]?d[1]:{},s=n.body,a=Object(y.a)(n,w),c={"Content-Type":"application/json"},o=Object(g.a)(Object(g.a)({method:s?"POST":"GET"},a),{},{headers:Object(g.a)(Object(g.a)({},c),a.headers)}),s&&(o.body=JSON.stringify(s)),t.prev=4,t.next=7,window.fetch(e,o);case 7:return u=t.sent,t.next=10,u.json();case 10:if(i=t.sent,!u.ok){t.next=13;break}return t.abrupt("return",{status:u.status,data:i,headers:u.headers,url:u.url});case 13:throw new Error(u.statusText);case 16:return t.prev=16,t.t0=t.catch(4),t.abrupt("return",Promise.reject(t.t0.message?t.t0.message:i));case 19:case"end":return t.stop()}}),t,null,[[4,16]])}))),k.apply(this,arguments)}S.get=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return S(t,Object(g.a)(Object(g.a)({},e),{},{method:"GET"}))},S.post=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return S(t,Object(g.a)(Object(g.a)({},n),{},{body:e}))};var N=Object(v.b)("posts/fetchPosts",Object(s.a)(Object(r.a)().mark((function t(){var e;return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S.get("/fakeApi/posts");case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}}),t)})))),C=Object(v.b)("posts/addNewPost",function(){var t=Object(s.a)(Object(r.a)().mark((function t(e){var n;return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S.post("/fakeApi/posts",e);case 2:return n=t.sent,t.abrupt("return",n.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),I=Object(v.c)({name:"posts",initialState:{posts:[],status:"idle",error:null},reducers:{reactionAdded:function(t,e){var n=e.payload,r=n.postId,s=n.reaction,a=t.posts.find((function(t){return t.id===r}));a&&a.reactions[s]++},postUpdated:function(t,e){var n=e.payload,r=n.id,s=n.title,a=n.content,c=t.posts.find((function(t){return t.id===r}));c&&(c.title=s,c.content=a)}},extraReducers:function(t){t.addCase(N.pending,(function(t,e){t.status="loading"})).addCase(N.fulfilled,(function(t,e){t.status="succeeded",t.posts=t.posts.concat(e.payload)})).addCase(N.rejected,(function(t,e){t.status="failed",t.error=e.error.message})).addCase(C.fulfilled,(function(t,e){t.posts.push(e.payload)}))}}),A=I.actions,P=(A.postAdded,A.postUpdated),T=A.reactionAdded,F=I.reducer,E=function(t){return t.posts.posts},q=function(t,e){return t.posts.posts.find((function(t){return t.id===e}))},U={thumbsUp:"\ud83d\udc4d",hooray:"\ud83c\udf89",heart:"\u2764\ufe0f",rocket:"\ud83d\ude80",eyes:"\ud83d\udc40"},M=function(t){var e=t.post,n=Object(l.b)(),r=Object.entries(U).map((function(t){var r=Object(x.a)(t,2),s=r[0],a=r[1];return Object(j.jsxs)("button",{type:"button",className:"muted-button reaction-button",onClick:function(){return n(T({postId:e.id,reaction:s}))},children:[a," ",e.reactions[s]]},s)}));return Object(j.jsx)("div",{children:r})},D=function(t){var e=t.post;return Object(j.jsxs)("article",{className:"post-excerpt",children:[Object(j.jsx)("h3",{children:e.title}),Object(j.jsxs)("div",{children:[Object(j.jsx)(O,{userId:e.user}),Object(j.jsx)(m,{timestamp:e.date})]}),Object(j.jsx)("p",{className:"post-content",children:e.content.substring(0,100)}),Object(j.jsx)(M,{post:e}),Object(j.jsx)(u.b,{to:"/posts/".concat(e.id),className:"button muted-button",children:"View Post"})]},e.id)},J=function(){var t,e=Object(l.b)(),n=Object(l.c)(E),r=Object(l.c)((function(t){return t.posts.status})),s=Object(l.c)((function(t){return t.posts.error}));if(Object(a.useEffect)((function(){"idle"===r&&e(N())}),[r,e]),"loading"===r)t=Object(j.jsx)(b,{text:"Loading..."});else if("succeeded"===r){t=n.slice().sort((function(t,e){return e.date.localeCompare(t.date)})).map((function(t){return Object(j.jsx)(D,{post:t},t.id)}))}else"failed"===r&&(t=Object(j.jsx)("div",{children:s}));return Object(j.jsxs)("section",{className:"posts-list",children:[Object(j.jsx)("h2",{children:"Posts"}),t]})},R=function(){var t=Object(a.useState)(""),e=Object(x.a)(t,2),n=e[0],c=e[1],o=Object(a.useState)(""),i=Object(x.a)(o,2),u=i[0],d=i[1],p=Object(a.useState)(""),b=Object(x.a)(p,2),O=b[0],f=b[1],h=Object(a.useState)("idle"),m=Object(x.a)(h,2),v=m[0],g=m[1],y=Object(l.b)(),w=Object(l.c)((function(t){return t.users})),S=[n,u,O].every(Boolean)&&"idle"===v,k=function(){var t=Object(s.a)(Object(r.a)().mark((function t(){return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!S){t.next=16;break}return t.prev=1,g("pending"),t.next=5,y(C({title:n,content:u,user:O})).unwrap();case 5:c(""),d(""),f(""),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),console.error("Failed to save the post: ",t.t0);case 13:return t.prev=13,g("idle"),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,10,13,16]])})));return function(){return t.apply(this,arguments)}}(),N=w.map((function(t){return Object(j.jsx)("option",{value:t.id,children:t.name},t.id)}));return Object(j.jsxs)("section",{children:[Object(j.jsx)("h2",{children:"Add a New Post"}),Object(j.jsxs)("form",{children:[Object(j.jsx)("label",{htmlFor:"postTitle",children:"Post Title:"}),Object(j.jsx)("input",{type:"text",id:"postTitle",name:"postTitle",placeholder:"What's on your mind?",value:n,onChange:function(t){return c(t.target.value)}}),Object(j.jsx)("label",{htmlFor:"postAuthor",children:"Author:"}),Object(j.jsxs)("select",{id:"postAuthor",value:O,onChange:function(t){return f(t.target.value)},children:[Object(j.jsx)("option",{value:""}),N]}),Object(j.jsx)("label",{htmlFor:"postContent",children:"Content:"}),Object(j.jsx)("textarea",{id:"postContent",name:"postContent",value:u,onChange:function(t){return d(t.target.value)}}),Object(j.jsx)("button",{type:"button",onClick:k,disabled:!S,children:"Save Post"})]})]})},K=function(t){var e=t.match.params.postId,n=Object(l.c)((function(t){return q(t,e)})),r=Object(a.useState)(n.title),s=Object(x.a)(r,2),c=s[0],o=s[1],i=Object(a.useState)(n.content),u=Object(x.a)(i,2),p=u[0],b=u[1],O=Object(l.b)(),f=Object(d.g)();return Object(j.jsxs)("section",{children:[Object(j.jsx)("h2",{children:"Edit Post"}),Object(j.jsxs)("form",{children:[Object(j.jsx)("label",{htmlFor:"postTitle",children:"Post Title:"}),Object(j.jsx)("input",{type:"text",id:"postTitle",name:"postTitle",placeholder:"What's on your mind?",value:c,onChange:function(t){return o(t.target.value)}}),Object(j.jsx)("label",{htmlFor:"postContent",children:"Content:"}),Object(j.jsx)("textarea",{id:"postContent",name:"postContent",value:p,onChange:function(t){return b(t.target.value)}})]}),Object(j.jsx)("button",{type:"button",onClick:function(){c&&p&&(O(P({id:e,title:c,content:p})),f.push("/posts/".concat(e)))},children:"Save Post"})]})},B=function(t){var e=t.match.params.postId,n=Object(l.c)((function(t){return q(t,e)}));return n?Object(j.jsx)("section",{children:Object(j.jsxs)("article",{className:"post",children:[Object(j.jsx)("h2",{children:n.title}),Object(j.jsxs)("div",{children:[Object(j.jsx)(O,{userId:n.user}),Object(j.jsx)(m,{timestamp:n.date})]}),Object(j.jsx)("p",{className:"post-content",children:n.content}),Object(j.jsx)(M,{post:n}),Object(j.jsx)(u.b,{to:"/editPost/".concat(n.id),className:"button",children:"Edit Post"})]})}):Object(j.jsx)("section",{children:Object(j.jsx)("h2",{children:"Post not found!"})})};var G,L=function(){return Object(j.jsxs)(u.a,{children:[Object(j.jsx)(p,{}),Object(j.jsx)("div",{className:"App",children:Object(j.jsxs)(d.d,{children:[Object(j.jsx)(d.b,{exact:!0,path:"/",render:function(){return Object(j.jsxs)(c.a.Fragment,{children:[Object(j.jsx)(R,{}),Object(j.jsx)(J,{})]})}}),Object(j.jsx)(d.b,{exact:!0,path:"/posts/:postId",component:B}),Object(j.jsx)(d.b,{exact:!0,path:"/editPost/:postId",component:K}),Object(j.jsx)(d.a,{to:"/"})]})})]})},W=Object(v.b)("users/fetchUsers",Object(s.a)(Object(r.a)().mark((function t(){var e;return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S.get("/fakeApi/users");case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}}),t)})))),z=Object(v.c)({name:"users",initialState:[],reducers:{},extraReducers:function(t){t.addCase(W.fulfilled,(function(t,e){return e.payload}))}}).reducer,V=Object(v.a)({reducer:{posts:F,users:z}}),H=n(8),Q=n(25),X=n(39),Y=n(172),Z=n(37),$=n(44),_=n.n($),tt=n(121),et=n.n(tt),nt=n(167),rt=n(168),st=["id"],at=2e3,ct=et()(),ot=localStorage.getItem("randomTimestampSeed");function it(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(ct()*(e-t+1))+t}ot?G=new Date(ot):(ot=(G=new Date).toISOString(),localStorage.setItem("randomTimestampSeed",ot)),ct=et()(ot),Object(rt.setRandom)(ct),_.a.seed(G.getTime());for(var ut,dt=function(t){return t[it(0,t.length-1)]},jt=Object(Z.factory)({user:{id:Object(Z.primaryKey)(v.d),firstName:String,lastName:String,name:String,username:String,posts:Object(Z.manyOf)("post")},post:{id:Object(Z.primaryKey)(v.d),title:String,date:String,content:String,reactions:Object(Z.oneOf)("reaction"),comments:Object(Z.manyOf)("comment"),user:Object(Z.oneOf)("user")},comment:{id:Object(Z.primaryKey)(String),date:String,text:String,post:Object(Z.oneOf)("post")},reaction:{id:Object(Z.primaryKey)(v.d),thumbsUp:Number,hooray:Number,heart:Number,rocket:Number,eyes:Number,post:Object(Z.oneOf)("post")}}),pt=function(){var t=_.a.name.firstName(),e=_.a.name.lastName();return{firstName:t,lastName:e,name:"".concat(t," ").concat(e),username:_.a.internet.userName()}},lt=0;lt<3;lt++)for(var bt=jt.user.create(pt()),Ot=0;Ot<3;Ot++){var ft=(ut=bt,{title:_.a.lorem.words(),date:_.a.date.recent(7).toISOString(),user:ut,content:_.a.lorem.paragraphs(),reactions:jt.reaction.create()});jt.post.create(ft)}var ht=function(t){return Object(g.a)(Object(g.a)({},t),{},{user:t.user.id})},mt=[X.c.get("/fakeApi/posts",(function(t,e,n){var r=jt.post.getAll().map(ht);return e(n.delay(at),n.json(r))})),X.c.post("/fakeApi/posts",(function(t,e,n){var r=t.body;if("error"===r.content)return e(n.delay(at),n.status(500),n.json("Server error saving this post!"));r.date=(new Date).toISOString();var s=jt.user.findFirst({where:{id:{equals:r.user}}});r.user=s,r.reactions=jt.reaction.create();var a=jt.post.create(r);return e(n.delay(at),n.json(ht(a)))})),X.c.get("/fakeApi/posts/:postId",(function(t,e,n){var r=jt.post.findFirst({where:{id:{equals:t.params.postId}}});return e(n.delay(at),n.json(ht(r)))})),X.c.patch("/fakeApi/posts/:postId",(function(t,e,n){var r=t.body,s=(r.id,Object(y.a)(r,st)),a=jt.post.update({where:{id:{equals:t.params.postId}},data:s});return e(n.delay(at),n.json(ht(a)))})),X.c.get("/fakeApi/posts/:postId/comments",(function(t,e,n){var r=jt.post.findFirst({where:{id:{equals:t.params.postId}}});return e(n.delay(at),n.json({comments:r.comments}))})),X.c.post("/fakeApi/posts/:postId/reactions",(function(t,e,n){var r=t.params.postId,s=t.body.reaction,a=jt.post.findFirst({where:{id:{equals:r}}}),c=jt.post.update({where:{id:{equals:r}},data:{reactions:Object(g.a)(Object(g.a)({},a.reactions),{},Object(Q.a)({},s,a.reactions[s]+=1))}});return e(n.delay(at),n.json(ht(c)))})),X.c.get("/fakeApi/notifications",(function(t,e,n){var r=wt(void 0,it(1,5),jt);return e(n.delay(at),n.json(r))})),X.c.get("/fakeApi/users",(function(t,e,n){return e(n.delay(at),n.json(jt.user.getAll()))}))],xt=Y.a.apply(void 0,mt),vt=new nt.Server("ws://localhost"),gt=function(t,e){!function(t,e){t.send(JSON.stringify(e))}(t,{type:"notifications",payload:wt(e,it(1,5),jt)})};vt.on("connection",(function(t){t,t.on("message",(function(e){var n=JSON.parse(e);if("notifications"===n.type){var r=n.payload;gt(t,r)}}))}));var yt=["poked you","says hi!","is glad we're friends","sent you a gift"];function wt(t,e,n){var r,s=new Date;t?r=Object(f.a)(t):(r=new Date(s.valueOf())).setMinutes(r.getMinutes()-15);var a=Object(H.a)(Array(e)).map((function(){var t=dt(n.user.getAll()),e=dt(yt);return{id:Object(v.d)(),date:_.a.date.between(r,s).toISOString(),message:e,user:t.id}}));return a}function St(){return(St=Object(s.a)(Object(r.a)().mark((function t(){return Object(r.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,xt.start({onUnhandledRequest:"bypass"});case 2:V.dispatch(W()),i.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(l.a,{store:V,children:Object(j.jsx)(L,{})})}),document.getElementById("root"));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){St.apply(this,arguments)}()},178:function(t,e,n){}},[[1369,1,2]]]);
//# sourceMappingURL=main.0eed9e84.chunk.js.map